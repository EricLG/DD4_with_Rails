<%# Sidebloc content%>
<% content_for :sidebloc do %>
  <%= render "campaign_menu" %>
<% end %>

<div class="row">
  <h2 class="col-sm-12"><%= @campaign.name %></h2>
</div>

<div class="row">
  <div class="col-sm-8">
      <h3>Maître du jeu : <%= @campaign.game_master.name %></h3>
      <p><%= simple_format @campaign.description %></p>

      <% if @current_user == @campaign.game_master && @wishlist_to_show %>
        <h3>Héros et leur liste de souhait:</h3>
        <% if !@characters.blank? %>
          <% @characters.each do |character| %>
            <div class="panel-group col-sm-12" role="tablist" aria-multiselectable="true">
              <div class="panel panel-default">
                <% panel_heading_id = "h#{character.name}" %>
                <div class="panel-heading" role="tab" id="<%= panel_heading_id %>">
                  <h4 class="panel-title">
                  <% collapse_id = character.name %>
                  <a role="button" data-toggle="collapse" href=<%="\##{collapse_id}"%> aria-expanded="true" aria-controls="<%= collapse_id %>">
                    <%= collapse_id %> joué par <%= character.user.name %>&nbsp;<span class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>
                  </a>
                  </h4>
                </div>
                <div id="<%= collapse_id %>" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="<%= panel_heading_id %>">
                  <div class="panel-body">
                    <ul class="">
                    <% character.magic_items.each do |item| %>
                        <li class=""><%= link_to item.name, items_magic_item_path(item.id) %></li>
                    <% end %>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      <% end %>
  </div>

  <div class="col-sm-4">
    <h3><small><%= t('.count_game', count: @games.size) %></small></h3>
    <ul class="list-group padding-left">
    <% @games.each do |g| %>
      <li><%= link_to "Partie du #{g.played.strftime("%d/%m/%Y")}", campaign_game_path(@campaign, g) %></li>
    <% end %>
    </ul>
    <p><%= link_to t('.new_game_link'), new_campaign_game_path(@campaign.id) %></p>
  </div>
</div>

<div class="row">
  <div class=col-sm-8>
    <% if @rp_comments.empty? %>
        <p>Il n'y a actuellement aucun commentaires roleplay</p>
    <% else %>
        <p>Commentaires roleplay :</p>
        <br>
        <%= render @rp_comments %>
    <% end %>
  </div>
</div>

<div class="row">
  <div class=col-sm-8>
    <% if @debrief_comments.empty? %>
        <p>Il n'y a actuellement aucun commentaires roleplay</p>
    <% else %>
        <p>Debriefing :</p>
        <br>
        <%= render @debrief_comments %>
    <% end %>
  </div>
</div>

<div class="row">
  <div class=col-sm-8>
    <% if @note_comments.empty? %>
        <p>Il n'y a actuellement aucun commentaires roleplay</p>
    <% else %>
        <p>Note personnelles :</p>
        <br>
        <%= render @note_comments %>
    <% end %>
  </div>
</div>

<div class="row">
  <div class=col-sm-8>
      <% if @current_user %>
          <hr />
          <%= render 'comments/form', comment_url: [@campaign, @comment] %>
      <% else %>
          <p>Connectez-vous pour écrire un commentaire.</p>
      <% end %>
  </div>
</div>
<hr>
<div class="row">
  <div class=col-sm-8>
    <p><%= link_to t('.update_campaign_link'), edit_campaign_path(@campaign) %></p>
  </div>
</div>
